jobs:
  ios-build:
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: 'latest'
      - name: Run Flutter commands
        run: |
          flutter pub get
          flutter precache --ios
          flutter build ios --debug --no-codesign
      - name: Install CocoaPods
        run: |
          cd ios
          pod install
      - name: Ensure xcconfig exists
        run: |
          if [ ! -f ios/Flutter/Debug.xcconfig ]; then echo 'Debug.xcconfig not found'; exit 1; fi
      - name: Build iOS
        run: |
          xcodebuild -workspace Runner.xcworkspace -scheme Runner -sdk iphonesimulator -configuration Debug